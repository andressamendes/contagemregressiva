<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Milena ❤️</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Alterado para display=block para evitar a troca brusca de fonte -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500&family=Great+Vibes&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&display=block" rel="stylesheet">
    <style>
        /* Reset e Base */
        body {
            font-family: 'Montserrat', sans-serif;
            overflow: hidden;
            background: linear-gradient(-45deg, #fff0f5, #ffe4e6, #fce7f3, #fdf2f8);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            cursor: pointer;
            height: 100dvh;
            width: 100vw;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        /* Classe para esconder conteúdo até a fonte carregar */
        .loading-fonts {
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
        }
        
        .fonts-loaded-active {
            opacity: 1;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .romantic-font { font-family: 'Great Vibes', cursive; }
        .elegant-font { font-family: 'Cormorant Garamond', serif; }

        /* Vidro Premium */
        .glass-panel {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 15px 40px rgba(225, 29, 72, 0.1);
        }

        /* Scrollbar customizada */
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(244, 63, 94, 0.3); border-radius: 10px; }

        /* Animações */
        .zoom-in-enter { animation: zoomIn 1s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
        @keyframes zoomIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* Partículas (Vagalumes) */
        .firefly {
            position: absolute; width: 4px; height: 4px; background-color: #fda4af;
            border-radius: 50%; opacity: 0; pointer-events: none; z-index: 0;
            box-shadow: 0 0 10px 2px rgba(251, 113, 133, 0.4);
            animation: fly 15s infinite ease-in-out;
        }
        @keyframes fly {
            0% { transform: translate(0, 0) scale(0); opacity: 0; }
            10% { opacity: 0.8; }
            50% { transform: translate(60px, -60px) scale(1.2); opacity: 0.5; }
            100% { transform: translate(-40px, -120px) scale(0); opacity: 0; }
        }

        /* Elementos Flutuantes */
        .element-float {
            position: absolute; animation: floatUp linear forwards;
            opacity: 0; pointer-events: none; z-index: 20;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) scale(0.5); opacity: 1; }
            100% { transform: translateY(-100px) scale(1.2); opacity: 0; }
        }

        .heart-style { color: rgba(244, 63, 94, 0.6); text-shadow: 0 0 5px rgba(255,255,255,0.6); }
        .lyric-style {
            position: absolute; bottom: -10vh; z-index: 1;
            color: rgba(157, 23, 77, 0.7); font-family: 'Great Vibes', cursive;
            white-space: nowrap; font-size: 1.5rem;
            text-shadow: 0 2px 8px rgba(255,255,255,0.8);
            animation: floatLyric 18s linear forwards;
        }
        @keyframes floatLyric {
            0% { transform: translateY(0); opacity: 0; }
            10% { opacity: 0.8; }
            100% { transform: translateY(-110vh); opacity: 0; }
        }

        /* Overlay Inicial */
        #start-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 241, 242, 0.98); z-index: 999;
            display: flex; align-items: center; justify-content: center;
            transition: opacity 0.8s ease;
        }
        
        /* Estado desabilitado do overlay (enquanto carrega) */
        .overlay-disabled { pointer-events: none; opacity: 0.8; }

        /* Cursor piscante */
        .typing-effect { border-right: 2px solid rgba(225, 29, 72, 0.6); padding-right: 2px; }

        /* Botão Envelope */
        .envelope-btn {
            position: absolute; bottom: 1.5rem; right: 1.5rem;
            background: white; color: #e11d48;
            border-radius: 50%; width: 3.2rem; height: 3.2rem;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 20px rgba(225, 29, 72, 0.25);
            transition: transform 0.2s; z-index: 50;
            animation: floatIcon 3s ease-in-out infinite;
        }
        .envelope-btn:active { transform: scale(0.9); }
        @keyframes floatIcon { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }

        /* Modal da Carta */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 241, 242, 0.6);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            z-index: 1000; display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.4s ease;
        }
        .modal-active { opacity: 1; pointer-events: auto; }
        
        .letter-paper {
            background: #fff; width: 85%; max-width: 480px; padding: 2rem 1.5rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1); border-radius: 8px;
            transform: translateY(30px) scale(0.95);
            transition: transform 0.5s cubic-bezier(0.19, 1, 0.22, 1);
            position: relative;
            background-image: linear-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 100% 1.8rem;
            line-height: 1.8rem;
        }
        .modal-active .letter-paper { transform: translateY(0) scale(1); }
        
        /* Ajuste de Texto na Carta para bater com as linhas */
        .letter-content { margin-top: 0.3rem; }

        /* Breakpoints Mobile */
        @media (max-width: 380px) {
            .timer-number { font-size: 2.5rem !important; }
            .timer-label { font-size: 0.5rem !important; }
            .timer-separator { font-size: 2rem !important; margin-top: 0.5rem !important; }
            .romantic-title { font-size: 2rem !important; }
        }
        
        /* Player Hack (Ajustado) */
        #youtube-player {
             position: fixed; top: 0; left: 0; width: 1px; height: 1px; opacity: 0.01; pointer-events: none; z-index: -1;
        }
    </style>
</head>
<body>

    <!-- Player YouTube -->
    <div id="youtube-player"></div>

    <!-- Partículas de Fundo -->
    <div id="particles-container" class="absolute inset-0 overflow-hidden pointer-events-none"></div>

    <!-- TELA INICIAL (Gatilho de Áudio) -->
    <!-- Adicionada classe loading-fonts para esconder o texto inicial até a fonte carregar -->
    <div id="start-overlay" class="overlay-disabled">
        <div class="text-center relative z-10 p-6 w-full cursor-pointer loading-fonts" id="start-content" onclick="startExperience()">
            <div class="mb-8 relative inline-block">
                <div class="absolute inset-0 bg-rose-200 blur-2xl opacity-40 rounded-full animate-pulse"></div>
                <h1 class="romantic-font text-6xl md:text-7xl text-rose-500 relative drop-shadow-sm">Para Milena...</h1>
            </div>
            <div class="flex flex-col items-center gap-3">
                <p id="start-text" class="text-rose-400 font-medium tracking-[0.2em] text-xs uppercase animate-pulse">Carregando surpresa...</p>
                <div id="start-icon" class="w-8 h-8 rounded-full border border-rose-300 flex items-center justify-center animate-spin text-rose-400 opacity-70">
                   <!-- Ícone de loading inicial -->
                   <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg>
                </div>
            </div>
        </div>
    </div>

    <!-- CONTEÚDO PRINCIPAL -->
    <div id="main-content" class="relative z-10 w-full h-full flex flex-col items-center justify-center p-4 md:p-6 opacity-0 transition-opacity duration-1000 hidden">
        
        <!-- Painel de Vidro -->
        <div class="glass-panel w-full max-w-lg rounded-[2rem] p-5 md:p-10 text-center relative flex flex-col items-center max-h-[90dvh] overflow-y-auto custom-scrollbar zoom-in-enter">
            
            <!-- Saudação -->
            <h3 id="greeting-text" class="romantic-font text-4xl md:text-5xl text-rose-500 mb-1 mt-2 romantic-title">Olá, amor</h3>
            <p class="text-[10px] md:text-xs tracking-[0.25em] uppercase text-rose-400 mb-6 font-semibold opacity-80">Contagem para nosso encontro</p>
            
            <!-- TIMER PRINCIPAL -->
            <div class="flex justify-center items-start gap-2 md:gap-5 mb-6 w-full text-rose-600">
                <!-- Dias -->
                <div class="flex flex-col items-center w-1/4">
                    <span id="days" class="timer-number text-4xl md:text-6xl font-extralight tracking-tighter leading-none">00</span>
                    <span class="timer-label text-[9px] md:text-[10px] uppercase tracking-widest mt-1 opacity-70 font-semibold">Dias</span>
                </div>
                <span class="timer-separator text-2xl md:text-4xl font-light text-rose-400 mt-2">:</span>
                <!-- Horas -->
                <div class="flex flex-col items-center w-1/4">
                    <span id="hours" class="timer-number text-4xl md:text-6xl font-extralight tracking-tighter leading-none">00</span>
                    <span class="timer-label text-[9px] md:text-[10px] uppercase tracking-widest mt-1 opacity-70 font-semibold">Horas</span>
                </div>
                <span class="timer-separator text-2xl md:text-4xl font-light text-rose-400 mt-2">:</span>
                <!-- Min -->
                <div class="flex flex-col items-center w-1/4">
                    <span id="minutes" class="timer-number text-4xl md:text-6xl font-extralight tracking-tighter leading-none">00</span>
                    <span class="timer-label text-[9px] md:text-[10px] uppercase tracking-widest mt-1 opacity-70 font-semibold">Min</span>
                </div>
                <span class="timer-separator text-2xl md:text-4xl font-light text-rose-400 mt-2">:</span>
                <!-- Seg -->
                <div class="flex flex-col items-center w-1/4">
                    <span id="seconds" class="timer-number text-4xl md:text-6xl font-extralight tracking-tighter leading-none w-[1.8em] text-center">00</span>
                    <span class="timer-label text-[9px] md:text-[10px] uppercase tracking-widest mt-1 opacity-70 font-semibold">Seg</span>
                </div>
            </div>

            <!-- Divisor -->
            <div class="w-2/3 h-px bg-gradient-to-r from-transparent via-rose-300 to-transparent mb-5 opacity-40"></div>

            <!-- Timer Passado (COM ÊNFASE) -->
            <div class="mb-6 opacity-100 w-full bg-white/20 rounded-xl p-4 shadow-sm border border-rose-100/30">
                <p class="text-[10px] md:text-xs tracking-[0.2em] uppercase text-rose-500 mb-2 font-bold">Desde nosso primeiro beijo</p>
                <div class="flex items-center justify-center gap-2">
                    <span class="text-xl">✨</span>
                    <p id="past-time" class="elegant-font text-rose-600 text-xl md:text-2xl italic leading-tight font-semibold">Carregando...</p>
                    <span class="text-xl">✨</span>
                </div>
            </div>

            <!-- Frase -->
            <div class="min-h-[3rem] md:min-h-[4rem] flex items-center justify-center mb-4 px-2">
                <h2 id="typewriter-text" class="romantic-font text-2xl md:text-4xl text-rose-600 drop-shadow-sm leading-tight transition-all text-center"></h2>
            </div>

            <!-- Botão Segredo -->
            <button onclick="showLoveReason(event)" class="group relative px-5 py-2 rounded-full bg-white/80 border border-rose-200 text-rose-500 shadow-sm hover:shadow-md transition-all duration-300 flex items-center gap-2 mb-2 active:scale-95">
                <span class="text-sm md:text-base">❤️</span>
                <span id="reason-btn-text" class="text-xs md:text-sm font-medium tracking-wide">Clique para um segredo</span>
            </button>
            
            <p id="love-reason" class="min-h-[1.5rem] mt-2 text-rose-600 italic elegant-font text-base md:text-lg transition-all duration-500 opacity-0 transform translate-y-2 px-2"></p>

            <div class="h-8 md:h-0"></div>
        </div>
    </div>

    <!-- Botão Carta -->
    <button onclick="toggleLetter()" class="envelope-btn hidden" id="envelope-trigger" aria-label="Abrir carta">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </button>

    <!-- Modal da Carta -->
    <div id="letter-modal" class="modal-overlay" onclick="toggleLetter()">
        <div class="letter-paper" onclick="event.stopPropagation()">
            <div class="absolute top-2 right-2 p-2 opacity-50 cursor-pointer" onclick="toggleLetter()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </div>
            
            <h3 class="romantic-font text-3xl text-rose-600 mb-1 mt-1 ml-2">Amor...</h3>
            
            <div class="letter-content elegant-font text-base md:text-lg text-gray-700">
                <p>Escrevo isso enquanto conto os segundos para te ver. Cada momento longe parece uma eternidade, mas saber que logo estarei com você faz tudo valer a pena.</p>
                <p class="mt-4">Mal posso esperar pelo nosso dia 26.</p>
            </div>
            
            <div class="flex justify-end items-end mt-6">
                <p class="text-right text-rose-500 romantic-font text-2xl mr-2 mb-0">- Com amor, Andressa</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <script>
        // --- CONFIGURAÇÕES ---
        const targetDate = new Date("2026-01-26T20:00:00").getTime();
        const firstKissDate = new Date("2025-09-07T23:00:00").getTime();
        const mainPhrase = "A gente se escolhe todo dia";
        
        const reasons = [
            "Amo o jeito que você sorri.", "Você me faz sentir em casa.",
            "Adoro nossas conversas infinitas.", "Seu abraço é meu lugar favorito.",
            "Com você, o mundo fica mais leve.", "Amo cada detalhe seu.",
            "Você é minha melhor escolha.", "Nossos planos são meus sonhos."
        ];

        const lyrics = [
            "Pra você eu me desmonto", "Minha voz no teu ouvido",
            "Não há nenhum perigo", "Agora eu durmo bem",
            "Milhões de vidas", "Uma só é pouco",
            "Tudo que eu puder viver", "A gente se escolhe",
            "Nós dois", "Explodir de amor", "Andressa & Milena"
        ];

        let player;
        let timerInterval;
        let typeIdx = 0;
        let isPlayerReady = false;

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('youtube-player', {
                height: '1', width: '1', videoId: 'nbZTVUduKBY',
                playerVars: { 'playsinline': 1, 'controls': 0, 'loop': 1, 'autoplay': 0 },
                events: {
                    'onReady': onPlayerReady,
                    'onError': onPlayerError
                }
            });
        }

        function onPlayerReady(event) {
            isPlayerReady = true;
            // Atualiza a tela para dizer que está pronto
            updateStartScreenReady();
        }
        
        function onPlayerError(event) {
            console.log("Erro no player, liberando entrada.");
            isPlayerReady = true;
            updateStartScreenReady();
        }
        
        function updateStartScreenReady() {
            const textEl = document.getElementById('start-text');
            const iconEl = document.getElementById('start-icon');
            const overlay = document.getElementById('start-overlay');
            
            if(textEl) {
                textEl.innerText = "Toque para ouvir nossa música";
                textEl.classList.remove('animate-pulse');
                textEl.classList.add('animate-bounce');
            }
            
            if(iconEl) {
                iconEl.innerHTML = '<svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>';
                iconEl.classList.remove('animate-spin');
                iconEl.classList.add('animate-ping');
            }
            
            if(overlay) {
                overlay.classList.remove('overlay-disabled');
            }
        }
        
        // Timeout de segurança
        setTimeout(() => {
            if(!isPlayerReady) {
                isPlayerReady = true;
                updateStartScreenReady();
            }
        }, 4000);

        // --- GESTÃO DE CLIQUES ---
        document.addEventListener('click', (e) => {
            if(e.target.closest('button')) return;
            createHeartAt(e.clientX, e.clientY);
        });

        function createHeartAt(x, y) {
            const el = document.createElement('div');
            el.innerHTML = '❤️';
            el.style.position = 'absolute';
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            el.style.fontSize = (Math.random() * 1 + 1) + 'rem';
            el.style.pointerEvents = 'none';
            el.style.zIndex = '100';
            el.style.transform = 'translate(-50%, -50%)'; 
            el.style.animation = 'floatClick 1.5s ease-out forwards';
            
            const style = document.createElement('style');
            style.innerHTML = `@keyframes floatClick { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; } 100% { transform: translate(-50%, -150px) scale(1.5); opacity: 0; } }`;
            document.head.appendChild(style);
            
            document.body.appendChild(el);
            setTimeout(() => { el.remove(); style.remove(); }, 1500);
        }

        // --- CONTROLE DE FONTES (CORREÇÃO DE BUG) ---
        // Espera as fontes carregarem para mostrar o texto inicial
        document.fonts.ready.then(function() {
            const startContent = document.getElementById('start-content');
            if(startContent) {
                startContent.classList.add('fonts-loaded-active');
            }
        });

        // --- INICIAR EXPERIÊNCIA ---
        function startExperience() {
            if(!isPlayerReady) return;

            try { 
                if (player && player.playVideo) { 
                    player.unMute(); 
                    player.playVideo(); 
                    player.setVolume(100); 
                } 
            } catch(e) {}

            setGreeting();

            const overlay = document.getElementById('start-overlay');
            const content = document.getElementById('main-content');
            const envelope = document.getElementById('envelope-trigger');
            
            overlay.style.opacity = '0'; overlay.style.pointerEvents = 'none';

            setTimeout(() => {
                overlay.style.display = 'none';
                content.classList.remove('hidden'); envelope.classList.remove('hidden');
                requestAnimationFrame(() => content.classList.remove('opacity-0'));
            }, 600);

            updateTimers();
            timerInterval = setInterval(updateTimers, 1000);
            initParticles();
            startFloatingElements();
            setTimeout(typeWriter, 1200);
        }

        function setGreeting() {
            const hour = new Date().getHours();
            const el = document.getElementById('greeting-text');
            let greeting = "Olá";
            if (hour >= 5 && hour < 12) greeting = "Bom dia";
            else if (hour >= 12 && hour < 18) greeting = "Boa tarde";
            else greeting = "Boa noite";
            el.innerText = `${greeting}, amor`;
        }

        function updateTimers() {
            const now = new Date().getTime();
            const distance = targetDate - now;
            
            if (distance < 0) {
                ['days', 'hours', 'minutes', 'seconds'].forEach(id => document.getElementById(id).innerText = "00");
            } else {
                const d = Math.floor(distance / (1000 * 60 * 60 * 24));
                const h = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((distance % (1000 * 60)) / 1000);
                document.getElementById('days').innerText = String(d).padStart(2, '0');
                document.getElementById('hours').innerText = String(h).padStart(2, '0');
                document.getElementById('minutes').innerText = String(m).padStart(2, '0');
                document.getElementById('seconds').innerText = String(s).padStart(2, '0');
            }

            const pastDiff = now - firstKissDate;
            if (pastDiff > 0) {
                const pd = Math.floor(pastDiff / (1000 * 60 * 60 * 24));
                const ph = Math.floor((pastDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                document.getElementById('past-time').innerText = `${pd} dias e ${ph} horas de nós`;
            }
        }

        function typeWriter() {
            if (typeIdx < mainPhrase.length) {
                const el = document.getElementById("typewriter-text");
                el.innerHTML += mainPhrase.charAt(typeIdx);
                el.classList.add("typing-effect");
                typeIdx++; setTimeout(typeWriter, 100);
            } else {
                setTimeout(() => {
                    const el = document.getElementById("typewriter-text");
                    el.classList.remove("typing-effect");
                    el.style.borderRight = "none";
                }, 1500);
            }
        }

        function toggleLetter() { document.getElementById('letter-modal').classList.toggle('modal-active'); }

        function showLoveReason(e) {
            e.stopPropagation();
            const el = document.getElementById('love-reason');
            const btnText = document.getElementById('reason-btn-text');
            el.classList.remove('opacity-100', 'translate-y-0'); el.classList.add('opacity-0', 'translate-y-2');
            setTimeout(() => {
                const randomReason = reasons[Math.floor(Math.random() * reasons.length)];
                el.innerText = `"${randomReason}"`;
                btnText.innerText = "Ver outro segredo...";
                el.classList.remove('opacity-0', 'translate-y-2'); el.classList.add('opacity-100', 'translate-y-0');
            }, 300);
        }

        function initParticles() {
            const container = document.getElementById('particles-container');
            for(let i=0; i<30; i++) {
                const p = document.createElement('div');
                p.classList.add('firefly');
                p.style.left = Math.random() * 100 + 'vw'; p.style.top = Math.random() * 100 + 'vh';
                p.style.animationDelay = Math.random() * 5 + 's';
                p.style.animationDuration = (Math.random() * 10 + 10) + 's';
                container.appendChild(p);
            }
        }

        function createFloater(isLyric = false) {
            const container = document.getElementById('particles-container');
            const el = document.createElement('div');
            el.classList.add('element-float');

            if (isLyric) {
                const text = lyrics[Math.floor(Math.random() * lyrics.length)];
                el.innerText = text; el.classList.add('lyric-style');
                el.style.left = (Math.random() * 80 + 10) + 'vw'; 
                el.style.animationDuration = (Math.random() * 8 + 12) + 's'; 
            } else {
                el.innerText = '❤️'; el.classList.add('heart-style');
                el.style.fontSize = (Math.random() * 1.5 + 0.8) + 'rem';
                el.style.left = Math.random() * 100 + 'vw';
                el.style.animationDuration = (Math.random() * 5 + 6) + 's';
            }
            container.appendChild(el);
            setTimeout(() => el.remove(), 20000);
        }

        function startFloatingElements() {
            setInterval(() => createFloater(false), 1200);
            setInterval(() => createFloater(true), 4000);
        }
    </script>
</body>
</html>
